-- obtener una tabla que tenga, cancion, mood, votos positivos, votos negativos 
create OR REPLACE view moods_general as select tabla_like.id_track, tabla_like.id_moods, tabla_like.nombre, tabla_like.votos_like, tabla_dislike.votos_dislike from (select id_moods,leyenda_mood.nombre, moods.id_track, count(vote) as votos_like from votos_moods join moods on moods.id = votos_moods.id_moods join leyenda_mood on leyenda_mood.id = moods.id_leyenda_mood group by id_moods, vote, moods.id_track, leyenda_mood.nombre having vote = 'like' order by votos_like DESC) as tabla_like join (select id_moods,leyenda_mood.nombre, moods.id_track, count(vote) as votos_dislike from votos_moods join moods on moods.id = votos_moods.id_moods join leyenda_mood on leyenda_mood.id = moods.id_leyenda_mood group by id_moods, vote, moods.id_track, leyenda_mood.nombre having vote = 'zero' order by votos_dislike DESC) as tabla_dislike on tabla_like.id_track = tabla_dislike.id_track;
